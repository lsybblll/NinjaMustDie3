<!DOCTYPE html>
<html>
<head>
	<title>伤害时间计算</title>
	<script src="jquery-3.4.1.min.js"></script>
</head>
<style type="text/css">
	.div-out {
/*		float: left;
		width: 200px;*/
		display: table-cell;
		padding-right: 50px;
	}
	p {
		margin: 0px;
	}
	.div-line {
		margin-bottom: 10px;
	}
</style>
<body>
	<h1>伤害时间计算</h1>
	<div class="div-out" style="">
		<div class="div-line">
			<p>boss血量：</p><input type="number" id="bs_xl" value="300000">
		</div>
		<div class="div-line">
			<p>面板伤害：</p><input type="number" id="mb_sh" value="4109">
		</div>
		<div class="div-line">
			<p>属性伤害：</p><input type="number" id="sx_sh" value="0">
		</div>
		<div class="div-line">
			<p>飞镖附加伤害：</p><input type="number" id="fb_fj_sh" value="0">
		</div>
		<div class="div-line">
			<p>飞镖球冷却：</p><input type="number" id="fb_lq" value="6">
		</div>
		<div class="div-line">
			<input type="checkbox" id="fb_sx" checked="checked">飞镖球同属性
		</div>
		<div class="div-line">
			<p>忍术附加伤害：</p><input type="number" id="rs_fj_sh" value="100">
		</div>
		<div class="div-line">
			<p>忍术系数：</p><input type="number" id="rs_xs" value="22">
		</div>
		<div class="div-line">
			<p>武器附加伤害：</p><input type="number" id="wq_fj_sh" value="0">
		</div>
		<div class="div-line">
			<p>武器冷却缩减：</p><input type="number" id="wq_lq_sj" value="0">
		</div>
		<div class="div-line">
			<p>主武器系数：</p><input type="number" id="zwq_xs" value="6">
		</div>
		<div class="div-line">
			<p>主武器冷却：</p><input type="number" id="zwq_lq" value="35">
		</div>
		<div class="div-line">
			<input type="checkbox" id="zwq_sx" checked="checked">主武器同属性
		</div>
		<div class="div-line">
			<p>副武器系数：</p><input type="number" id="fwq_xs" value="5">
		</div>
		<div class="div-line">
			<p>副武器冷却：</p><input type="number" id="fwq_lq" value="29.5">
		</div>
		<div class="div-line">
			<input type="checkbox" id="fwq_sx" checked="checked">副武器同属性
		</div>
		<div class="div-line">
			<button onclick="calc()" style="width: 100%">计算</button>
		</div>
	</div>
	<div class="div-out">
		<div class="div-line">
			<p style="display: inline;">需要时间：</p><input type="number" id="xy_sj" value="0" disabled="disabled">
			<div id="info">
			</div>
		</div>
	</div>

	<div class="div-out">
		<h2>引用一下别人的数据</h2>
		<img src="wqxs.jpg"/>
	</div>
</body>
<script type="text/javascript">
	// 所有变量都是拼音缩写，自己拼去吧 
	// sh伤害 lq冷却 xs系数 xl血量 sx属性
	// 计算时间
	function calc() {
		var time = 0;
		var damage = 0;
		var bs_xl = +$('#bs_xl').val();
		var mb_sh = +$('#mb_sh').val();
		var sx_sh = +$('#sx_sh').val();
		var rs_fj_sh = +$('#rs_fj_sh').val();
		var rs_xs = +$('#rs_xs').val();
		var fb_fj_sh = +$('#fb_fj_sh').val();
		var fb_lq = +$('#fb_lq').val();
		var fb_sx = $('#fb_sx').is(":checked");	//主武器是否为对应属性
		var wq_fj_sh = +$('#wq_fj_sh').val();
		var wq_lq_sj = +$('#wq_lq_sj').val();
		var zwq_xs = +$('#zwq_xs').val();
		var zwq_lq = +$('#zwq_lq').val();
		var zwq_sx = $('#zwq_sx').is(":checked");	//主武器是否为对应属性
		var fwq_xs = +$('#fwq_xs').val();
		var fwq_lq = +$('#fwq_lq').val() * 4;
		var fwq_sx = $('#fwq_sx').is(":checked");	//副武器是否为对应属性

		var fb_index = 0;
		var zwq_index = 0;		// 初始认为主武器已经冷却
		var fwq_index = 0.6;	// 初始认为服务器已经冷却了40%

		var info = "";
		// 计算大招
		damage = (mb_sh + sx_sh + rs_fj_sh) * rs_xs;
		bs_xl -= damage;
		info += getFormatTime(time) + "忍术伤害" + damage + "</br>"

		while (bs_xl > 0) {
			// 判断飞镖球
			if (time / fb_lq >= fb_index) {
				fb_index++;
				damage = Math.floor((mb_sh + (fb_sx ? sx_sh : 0) + fb_fj_sh) / 100) * 100;
				bs_xl -= damage;
				info += getFormatTime(time) + "飞镖球" + damage + "</br>"
			}
			// 判断主武器
			if (time / zwq_lq >= zwq_index) {
				zwq_index++;
				damage = (mb_sh + (zwq_sx ? sx_sh : 0) + wq_fj_sh) * zwq_xs * (100 - wq_lq_sj) / 100;
				bs_xl -= damage;
				info += getFormatTime(time) + "主武器" + damage + "</br>"
			}
			// 判断飞镖球
			if (time / fwq_lq >= fwq_index) {
				fwq_index++;
				damage = (mb_sh + (fwq_sx ? sx_sh : 0) + wq_fj_sh) * fwq_xs * (100 - wq_lq_sj) / 100;
				bs_xl -= damage;
				info += getFormatTime(time) + "副武器" + damage + "</br>"
			}
			time++;
		}
		$('#info').html(info);
		$('#xy_sj').val(time - 1);
	}

	function getFormatTime(time) {
		var a = "00" + (time % 60);
		var b = "00" + (Math.floor(time / 60));
		return `[${b.substr(-2)}:${a.substr(-2)}]`
	}
</script>
</html>